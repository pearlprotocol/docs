# Authentication with @pearlx/react


`@pearlx/react` is a library that provides an authentication provider for React applications. It also includes a hook called usePearl that allows you to easily access authentication state and perform authentication-related actions.


# Usage

To use `@pearlx/react`, first import the `usePearl` hook from the library:

```ts
import { usePearl } from "@pearlx/react"
```

Next, use the `usePearl` hook in your main application component to access the authentication state and perform authentication-related actions:

```ts
function App() {
  const { signIn, signOut, user, isLoading, handleCallback } = usePearl();

  useEffect(() => {
    handleCallback();
  }, []);

  return (
    <div className="App">
      <button onClick={() => signIn()}> Sign In </button>
      <button onClick={() => signOut()}> Sign Out </button>
      <div>User address: {user?.address}</div>
      <div>Loading: {String(isLoading)}</div>
    </div>
  );
}

export default App;
```

The `usePearl` hook returns an object with the following properties:

`user`: The authenticated user, if available.
`isLoading`: A boolean indicating whether the authentication state is still being loaded.
`signIn`: A function that initiates the authentication process.
`signOut`: A function that signs the user out.
`handleCallback`: A function that handles the authentication callback after the user is redirected back to your application from the authentication provider.



### The signIn Function

The `signIn` function is used to initiate the authentication process. When the user clicks on the "Sign In" button, for example, you can call this function to start the authentication flow:

```ts
import { usePearl } from "@pearlx/react";

function App() {
  const { signIn } = usePearl();

  return (
    <div className="App">
      <button onClick={() => signIn()}> Sign In </button>
    </div>
  );
}

export default App;
```

### The signOut Function

The `signOut` function is used to sign the user out of your application. When the user clicks on the "Sign Out" button, for example, you can call this function to sign the user out:

```ts
import { usePearl } from "@pearlx/react";

function App() {
  const { signOut } = usePearl();

  return (
    <div className="App">
      <button onClick={() => signOut()}> Sign Out </button>
    </div>
  );
}

export default App;
```

### The user Constructor

The `user` constructor contains information about the currently authenticated user, if available. You can use this object to display user-specific content in your application:

```ts
import { usePearl } from "@pearlx/react";

function App() {
  const { user } = usePearl();

  return (
    <div className="App">
      {user ? (
        <div>Welcome, {user.email}!</div>
      ) : (
        <div>Please sign in.</div>
      )}
    </div>
  );
}

export default App;
```

### The isLoading Boolean

The `isLoading` boolean is used to indicate whether the authentication state is still being loaded. You can use this boolean to display a loading indicator until the authentication state is available:

```ts
import { usePearl } from "@pearlx/react";

function App() {
  const { isLoading } = usePearl();

  return (
    <div className="App">
      {isLoading ? (
        <div>Loading...</div>
      ) : (
        <div>Authentication state loaded.</div>
      )}
    </div>
  );
}

export default App;
```

### The handleCallback Function

The `handleCallback` function is used to handle the authentication callback after the user is redirected back to your application from the authentication provider. You should call this function inside a `useEffect` hook to ensure that it is only called once:

```ts
import { usePearl } from "@pearlx/react";

function App() {
  const { handleCallback } = usePearl();

  useEffect(() => {
    handleCallback();
  }, []);

  return (
    <div className="App">
      ...
    </div>
  );
}

export default App;
```



### The backupDeviceKey  Function

The `backupDeviceKey` function is used to generate a backup device key for the user. You should call this function inside a `useEffect` hook to ensure that it is only called once:

```ts
import { usePearl } from "@pearlx/react";

function App() {
  const { backupDeviceKey } = usePearl();

  useEffect(() => {
    backupDeviceKey("BACKUP_KEY FROM USER");
  }, []);

  return (
    <div className="App">
      ...
    </div>
  );
}

export default App;
```


### The solanaKey keypair

The `solanaKey` keypair is used to retrieve a solana keypair for the user. You should use this keypair to sign transactions for the user:

```ts
import { usePearl } from "@pearlx/react";

function App() {
  const { solanaKey } = usePearl();

  return (
    <div className="App">
      {solanakey ? (
        <div>Welcome, {solanaKey.publicKey}!</div>
      ) : (
        <div>Please sign in.</div>
      )}
    </div>
  );
}
```


### The evmKey keypair

The `evmKey` keypair is used to retrieve a evm keypair for the user. You should use this keypair to sign transactions for the user:

```ts
import { usePearl } from "@pearlx/react";

function App() {
  const { evmKey } = usePearl();

  return (
    <div className="App">
      {evmKey ? (
        <div>Welcome, {evmKey.address}!</div>
      ) : (
        <div>Please sign in.</div>
      )}
    </div>
  );
}
```

### The verifyKyc function

The `verifyKyc` function is used to verify the user's KYC status. You should call this function inside a `onClick` handler to ensure that it is only called once:

```ts

import { usePearl } from "@pearlx/react";

function App() {
  const { verifyKyc } = usePearl();

  return (
    <div className="App">
      <button onClick={() => verifyKyc()}> Verify KYC </button>
    </div>
  );
}
```